<!DOCTYPE html>
<html>
<body>
<div id="myExcelDiv" style="width: 1024px; height: 800px"></div>
<script type="text/javascript" src="http://r.office.microsoft.com/r/rlidExcelWLJS?v=1&kip=1"></script>
<script type="text/javascript">
	/*
	 * This code uses the Microsoft Office Excel Javascript object model to programmatically insert the
	 * Excel Web App into a div with id=myExcelDiv. The full API is documented at
	 * https://msdn.microsoft.com/en-US/library/hh315812.aspx. There you can find out how to programmatically get
	 * values from your Excel file and how to use the rest of the object model. 
	 */
	// Use this file token to reference SampleExcel.xlsx in Excel's APIs
	var fileToken = "SD31C7FF9A9733B3C1!111/3587116667650683841/t=0&s=0&v=!AHg-8_Je4zV6TiI";
	// run the Excel load handler on page load
	if (window.attachEvent) {
		window.attachEvent("onload", loadEwaOnPageLoad);
	} else {
		window.addEventListener("DOMContentLoaded", loadEwaOnPageLoad, false);
	}
	function loadEwaOnPageLoad() {
		var props = {
			uiOptions: {
				showDownloadButton: false,
				selectedCell: "'Sheet1'!D4",
				showParametersTaskPane: false
			},
			interactivityOptions: { 
                         allowParameterModification: false,
                         allowPivotTableInteractivity: false
			}
		};
		Ewa.EwaControl.loadEwaAsync(fileToken, "myExcelDiv", props, onEwaLoaded);
	}
	
	function onEwaLoaded(asyncResult) {
		if (asyncResult.getSucceeded())
	        {
	            // Use the AsyncResult.getEwaControl() method to get a reference to the EwaControl object
	            ewa = asyncResult.getEwaControl();
	            ewa.add_commitCellEditing(cellChanged);
	        }
	        else
	        {
	            alert("Async operation failed!");
	        }
	}
	
	// Handle the active cell changed event.
    function cellChanged(rangeEditArgs)
    {
  	// Get the value of the cell before editing
    	var oldValue = rangeEditArgs.getTargetOldUnformattedValue();
    	// Get the value of the cell after editing
    	var newValue = rangeEditArgs.getTargetUnformattedValue();
    	// Display the before and after values of the cell
    	alert("Old value: " + oldValue.toString() + "\nNew value: " + newValue.toString());
    	var o = "Set via code - by George Sanchez";
    	// Set the value of the cell via code
    	rangeEditArgs.setTargetUnformattedValue(o);
    }
</script>
</body>
</html>
